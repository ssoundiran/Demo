<aura:component implements="force:lightningQuickActionWithoutHeader,flexipage:availableForRecordHome,lightning:actionOverride,force:appHostable,flexipage:availableForAllPageTypes,force:hasRecordId" access="global" controller="CEP_ContractCreationPageController">
    <aura:attribute name="contracts" type="contract[]" default="[{ 'sobjectType' : 'contract'}]" />
    <aura:attribute name="entConfList" type="CEP_Entitlement_Configuration__c[]" default="[{ 'sobjectType' : 'CEP_Entitlement_Configuration__c'}]" />
    <aura:attribute name="AssetRec" type="asset" default="[{ 'sobjectType' : 'asset'}]" />
    <aura:attribute name="showSpinner" type="boolean" default="true" />
    <aura:attribute name="showcontractInfo" type="boolean" default="false" />
    <aura:attribute name="nocontract" type="boolean" default="false" />
    <aura:attribute name="prodName" type="String" default="" />
    <aura:attribute name="selectedEntConfigId" type="String" default="" />
    <aura:attribute name="selectedEntConfigName" type="String" default="" />
    <aura:attribute name="parentRMAList" type="CEP_RMA__c[]" default="" />
    <aura:attribute name="selectedAutoApply" type="String" default="" />
    <aura:attribute name="RMAItemType" type="boolean" default="false" />
    <aura:attribute name="firstName" type="String" default="" />
    <aura:attribute name="lastName" type="String" default="" />
    <aura:attribute name="shipStreet" type="String" default="" />
    <aura:attribute name="shipCity" type="String" default="" />
    <aura:attribute name="shipState" type="String" default="" />
    <aura:attribute name="shipCountry" type="String" default="" />
    <aura:attribute name="selectedParentRMA" type="String" default="" />
    <aura:attribute name="contractId" type="String" default="" />
    <aura:attribute name="shipPinCode" type="String" default="" />
    <aura:attribute name="shipPhone" type="String" default="" />
    <aura:attribute name="showPaymentFrame" type="boolean" default="false" />
    <aura:attribute name="showAutoCont" type="boolean" default="false" />
    <aura:attribute name="showNewCont" type="boolean" default="false" />
    <aura:attribute name="openmodal" type="boolean" default="false" />
    <aura:attribute name="contractExists" type="boolean" default="false" />
    <aura:attribute name="addressErrorModal" type="boolean" default="false" />
    <aura:attribute name="addressvalidation" type="boolean" default="false" />
    <aura:attribute name="parAssetId" type="String" default="" />
    <!--Added by Chitra-->
    <aura:attribute name="distributorName" type="Distributor_Address__c[]" default="" />
    <aura:attribute name="selectedDealer" type="String" default="" />
    <aura:attribute name="ShippingAddress2" type="String" default="" />
    <!--Added by Chitra-->
    <aura:attribute name="showparRMA" type="boolean" default="false" />
    <aura:attribute name="showDistName" type="boolean" default="false" />
    <aura:attribute name="shipCompany" type="String" default="" />
    <aura:attribute name="addressType" type="String" default="Business" />
    <aura:attribute name="autoApplycontracts" type="Contract[]" default="[{ 'sobjectType' : 'Contract'}]" />
    <aura:handler name="change" value="{!v.contractId}" action="{!c.intiatePayment}" />
    <aura:handler name="change" value="{!v.shipCountry}" action="{!c.onChangeCountry}" />
    <aura:attribute name="stateListShow" type="boolean" default="false" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:if isTrue="{!v.nocontract}">
        <div class="slds-grid slds-m-bottom_large">
            <h2>
                <div>
                    <span class="slds-text-heading_small">No Contracts to display</span>
                </div>
            </h2>
        </div>
    </aura:if>
    <aura:if isTrue="{!v.contractExists}">
        <div class="slds-grid slds-m-bottom_large">
            <h2>
                <div>
                    <span class="slds-text-heading_small">Contract Already Exits for RMA</span>
                </div>
            </h2>
        </div>
    </aura:if>
    <aura:if isTrue="{!v.showcontractInfo}">
        <div class="slds-size_1-of-1">
            <div class="slds-size_12-of-12 allTilesSection">
                <div class=" slds-size_12-of-12">
                    <article class="slds-card">
                        <div class="slds-card__body">
                            <div class="slds-grid slds-m-bottom_large">
                                <h2 class="slds-size_12-of-12 ">
                                        <span class="slds-align_absolute-center heading slds-p-left_small primaryPaletteBorder slds-theme--shade slds-section__title ">RMA Contract</span>
                                    </h2>
                            </div>
                            <div>
                                <span class="slds-text-heading_small">Customer Shipping Address</span>
                            </div>
                            <div class="slds-grid slds-m-bottom_medium">
                                <!-- Start Distributor Section -->
                                <div class="slds-size_1-of-2 slds-p-right_x-small">
                                    <aura:renderIf isTrue="{!v.showDistName}">
                                        <lightning:select name="" label="Distributor" required="true" value="{!v.selectedDealer}" messageWhenValueMissing="Please select a value" onchange="{!c.onChangeDealer}">
                                            <aura:iteration items="{!v.distributorName}" var="distributorName">
                                                <option value="{!distributorName.Name}" text="{!distributorName.Name}"></option>
                                            </aura:iteration>
                                        </lightning:select>
                                    </aura:renderIf> 
                                </div>
                                <!-- End Distributor Section -->
                            </div>
                            <div class="slds-grid slds-m-bottom_medium">
                                <div class="slds-size_1-of-2 slds-p-right_x-small">
                                            <lightning:input disabled="false" label="First Name" name="" value="{!v.firstName}" maxlength="100"/>
                                </div>
                                <div class="slds-size_1-of-2">
                                            <lightning:input disabled="false" label="Last Name" name="" value="{!v.lastName}" maxlength="100"/>
                                </div>
                            </div>
                            <div class="slds-grid slds-m-bottom_medium">
                                <div class="slds-size_1-of-2 slds-p-right_x-small">
                                    <lightning:input label="Shipping Street" name="" required="true" value="{!v.shipStreet}" maxlength="100"/>
                                </div>
                                <div class="slds-size_1-of-2">
                                    <lightning:input label="Shipping City" name="" required="true" value="{!v.shipCity}" maxlength="100" />
                                </div>
                            </div>
                            <div class="slds-grid slds-m-bottom_medium">
                                <aura:if isTrue="{!v.stateListShow}">
                                    <div class="slds-size_1-of-2 slds-p-right_x-small">
                                        <lightning:select name="" label="Shipping State" required="true" value="{!v.shipState}" messageWhenValueMissing="Please select a value" >
                                            <!-- <aura:iteration items="{!v.statesList}" var="states">
                                                <option value="{!states}" text="{!states}" selected="{!states == v.shipState}"></option>
                                            </aura:iteration> -->
                                            <option value="">-- None --</option>
                                            <option value="AL">Alabama</option>
                                            <option value="AK">Alaska</option>
                                            <option value="AZ">Arizona</option>
                                            <option value="AR">Arkansas</option>
                                            <option value="CA">California</option>
                                            <option value="CO">Colorado</option>
                                            <option value="CT">Connecticut</option>
                                            <option value="DE">Delaware</option>
                                            <option value="DC">Dist of Columbia</option>
                                            <option value="FL">Florida</option>
                                            <option value="GA">Georgia</option>
                                            <option value="HI">Hawaii</option>
                                            <option value="ID">Idaho</option>
                                            <option value="IL">Illinois</option>
                                            <option value="IN">Indiana</option>
                                            <option value="IA">Iowa</option>
                                            <option value="KS">Kansas</option>
                                            <option value="KY">Kentucky</option>
                                            <option value="LA">Louisiana</option>
                                            <option value="ME">Maine</option>
                                            <option value="MD">Maryland</option>
                                            <option value="MA">Massachusetts</option>
                                            <option value="MI">Michigan</option>
                                            <option value="MN">Minnesota</option>
                                            <option value="MS">Mississippi</option>
                                            <option value="MO">Missouri</option>
                                            <option value="MT">Montana</option>
                                            <option value="NE">Nebraska</option>
                                            <option value="NV">Nevada</option>
                                            <option value="NH">New Hampshire</option>
                                            <option value="NJ">New Jersey</option>
                                            <option value="NM">New Mexico</option>
                                            <option value="NY">New York</option>
                                            <option value="NC">North Carolina</option>
                                            <option value="ND">North Dakota</option>
                                            <option value="OH">Ohio</option>
                                            <option value="OK">Oklahoma</option>
                                            <option value="OR">Oregon</option>
                                            <option value="PA">Pennsylvania</option>
                                            <option value="RI">Rhode Island</option>
                                            <option value="SC">South Carolina</option>
                                            <option value="SD">South Dakota</option>
                                            <option value="TN">Tennessee</option>
                                            <option value="TX">Texas</option>
                                            <option value="UT">Utah</option>
                                            <option value="VT">Vermont</option>
                                            <option value="VA">Virginia</option>
                                            <option value="WA">Washington</option>
                                            <option value="WV">West Virginia</option>
                                            <option value="WI">Wisconsin</option>
                                            <option value="WY">Wyoming</option>
                                        </lightning:select>
                                    </div>
                                    <aura:set attribute="else">
                                        <div class="slds-size_1-of-2 slds-p-right_x-small">
                                            <lightning:input required="true" label="Shipping State" name="" value="{!v.shipState}" maxlength="100" />
                                        </div>
                                    </aura:set>
                                </aura:if>
                                <div class="slds-size_1-of-2">
                                    <lightning:input label="Shipping Country" name="" disabled="true" value="{!v.shipCountry}" maxlength="100" />
                                </div>
                            </div>
                            <div class="slds-grid slds-m-bottom_medium">
                                <div class="slds-size_1-of-2 slds-p-right_x-small">
                                    <lightning:input label="Shipping ZipCode" name="" required="true" value="{!v.shipPinCode}" maxlength="100" />
                                </div>
                            <div class="slds-size_1-of-2">
                                    <lightning:input label="Shipping Phone" name="" value="{!v.shipPhone}" required="true" maxlength="40"/>
                                </div>
                            </div>
                            <div class="slds-grid slds-m-bottom_medium">
                                <div class="slds-size_1-of-2 slds-p-right_x-small">
                                    <lightning:input label="Shipping Company" name="" value="{!v.shipCompany}" maxlength="100" />
                                </div>
                                <div class="slds-size_1-of-2">
                                    <lightning:select label="Address Type" value="{!v.addressType}" required="true" >
                                        <option value="Home">Home</option>  
                                        <option value="Business">Business</option>
                                       </lightning:select> 
                                </div>
                            </div>
                            <aura:if isTrue="{!v.showparRMA}">
                                <div class="slds-grid slds-m-bottom_medium">
                                    <div class="slds-size_1-of-2">
                                        <lightning:select name="" label="Parent RMA" required="true" value="{!v.selectedParentRMA}" messageWhenValueMissing="Please select a value" >
                                            <option value="" text="--None--"></option>    
                                            <aura:iteration items="{!v.parentRMAList}" var="parentRMA">
                                                <option value="{!parentRMA.Id}" text="{!parentRMA.Name}"></option>
                                            </aura:iteration>
                                        </lightning:select>
                                    </div>   
                                </div>
                            </aura:if>
                        </div>
                    </article>
                </div>
            </div>
        </div>
        <div class="slds-size_1-of-1">
            <div class="slds-size_12-of-12 allTilesSection">
                <div class=" slds-size_12-of-12">
                    <article class="slds-card">
                        <div class="slds-card__body">
                            <!--<aura:if isTrue="{!v.RMAItemType}">-->
                            <aura:if isTrue="{!v.showAutoCont}">
                                <div class="slds-grid">
                                    <h2>
                                        <div>
                                            <span class="slds-text-heading_small">Contracts with customer</span>
                                        </div>
                                    </h2>
                                </div>
                                <div class="slds-grid slds-m-bottom_large">
                                    <table class="custTable slds-table slds-table_bordered slds-table_cell-buffer">
                                        <thead>
                                            <tr class="slds-text-title_caps">
                                                <th scope="col">
                                                    <div class="slds-truncate" title=""></div>
                                                </th>
                                                <th scope="col">
                                                    <div class="slds-truncate" title="Contract Name">Contract Name</div>
                                                </th>
                                                <th scope="col">
                                                    <div class="slds-truncate" title="Contract Status">Contract Status</div>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <aura:iteration items="{!v.autoApplycontracts}" var="autoApplycontracts">
                                                <tr>
                                                    <td data-label="">
                                                        <div class="slds-truncate">
                                                            <!-- <lightning:input type="radio" name="" label="" value="" onchange="{!c.handleRadioChange}" /> -->
                                                            <span class="slds-radio">
                                                                <input type="radio" id="{!autoApplycontracts.CEP_Entitlement_Configuration__r.CEP_RMA_Contract__c}"  name="options" onchange="{!c.autoapplysave}"/>
                                                                <label class="slds-radio__label" for="{!autoApplycontracts.CEP_Entitlement_Configuration__r.CEP_RMA_Contract__c}">
                                                                    <span class="slds-radio--faux"></span>
                                                            <span class="slds-form-element__label"></span>
                                                            </label>
                                                            </span>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div class="slds-truncate">
                                                            <span>{!autoApplycontracts.CEP_Entitlement_Configuration__r.CEP_RMA_Contract__r.Name}</span>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div class="slds-truncate">
                                                            <span>{!autoApplycontracts.CEP_Entitlement_Configuration__r.CEP_RMA_Contract__r.CEP_Status__c}</span>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </aura:iteration>
                                        </tbody>
                                    </table>
                                </div>
                            </aura:if>
                            <aura:if isTrue="{!v.showNewCont}">
                                <div class="slds-grid">
                                    <h2>
                                        <div>
                                            <span class="slds-text-heading_small">Select Contract</span>
                                        </div>
                                    </h2>
                                </div>
                                <div class="slds-grid slds-m-bottom_large">
                                    <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                                        <thead>
                                            <tr class="slds-text-title_caps">
                                                <th scope="col">
                                                    <div class="slds-truncate" title=""></div>
                                                </th>
                                                <th scope="col">
                                                    <div class="slds-truncate" title="Contract Name">Contract Name</div>
                                                </th>
                                                <th scope="col">
                                                    <div class="slds-truncate" title="Currency">Currency</div>
                                                </th>
                                                <!--<th scope="col">
                                                    <div class="slds-truncate" title="Region">Region</div>
                                                </th>-->
                                                <th scope="col">
                                                    <div class="slds-truncate" title="Cost">Cost</div>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <aura:iteration items="{!v.entConfList}" var="entConfig">
                                                <tr>
                                                    <td data-label="">
                                                        <div class="slds-truncate">
                                                            <!-- <lightning:input type="radio" name="" label="" value="" onchange="{!c.handleRadioChange}" /> -->
                                                            <span class="slds-radio">
                                                                <input type="radio" id="{!entConfig.Id}"  data-entname="{!entConfig.Name}" name="options" onchange="{!c.savechecked}"/>
                                                                <label class="slds-radio__label" for="{!entConfig.Id}">
                                                                    <span class="slds-radio--faux"></span>
                                                            <span class="slds-form-element__label"></span>
                                                            </label>
                                                            </span>
                                                        </div>
                                                    </td>
                                                    <td class="custTable" data-label="">
                                                        <div class=""><span>{!entConfig.Name}</span></div>
                                                    </td>
                                                    <td class="custTable" data-label="">
                                                        <div class="slds-truncate"><span>{!entConfig.CurrencyIsoCode}</span></div>
                                                    </td>
                                                    <!--<td data-label="">
                                                        <div class="slds-truncate"><span>{!entConfig.CEP_Region__c}</span></div>
                                                    </td>-->
                                                    <td class="custTable" data-label="">
                                                        <div class="slds-truncate"><span>{!entConfig.CEP_Cost__c}</span></div>
                                                    </td>
                                                </tr>
                                            </aura:iteration>
                                        </tbody>
                                    </table>
                                </div>
                            </aura:if>
                            <!--</aura:if>-->
                        </div>
                    </article>
                </div>
            </div>
        </div>
        <div class="slds-grid slds-grid_align-center">
            <div class="slds-p-bottom_xx-large slds-p-left_small">
                <lightning:button label="Submit" onclick="{!c.contractSave}" variant="brand" class=" slds-button slds-button_brand" />
            </div>
            <div class="slds-p-bottom_xx-large slds-p-left_small">
                <lightning:button label="Cancel" onclick="{!c.closemodal}" variant="reset" class=" slds-button slds-button_neutral" />
            </div>
        </div>
        <div aura:id="formDiv" id="formDiv"></div>
        <div>
            <iframe src="" name="paymentFrame" id="paymentFrame" height="50%" width="100%" frameborder="0"></iframe>
        </div>
    </aura:if>
    <aura:if isTrue="{!v.openmodal}">
        <div role="dialog" tabindex="-1" aria-labelledby="header99" class="slds-modal slds-fade-in-open ">
            <div class="slds-modal__container">
                <div class="slds-modal__header" style="color:rgb(243, 81, 81)">
                    <button class="slds-button slds-modal__close slds-button--icon-inverse slds-text-heading_large" title="Close" onclick="{!c.closeErrorModal}">
                        <span>x</span>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Save Error</h2>
                </div>
                <div class="slds-modal__content slds-p-around--medium">
                    Please select a contract.
                </div>
                <div class="slds-modal__footer">
                    <button class="slds-button slds-button--neutral" onclick="{!c.closeErrorModal}">Ok</button>
                </div>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
    </aura:if>
    <aura:if isTrue="{!v.addressErrorModal}">
        <div role="dialog" tabindex="-1" aria-labelledby="header99" class="slds-modal slds-fade-in-open ">
            <div class="slds-modal__container">
                <div class="slds-modal__header" style="color:rgb(243, 81, 81)">
                    <button class="slds-button slds-modal__close slds-button--icon-inverse slds-text-heading_large" title="Close" onclick="{!c.closeShipErrorModal}">
                        <span>x</span>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Save Error</h2>
                </div>
                <div class="slds-modal__content slds-p-around--medium">                    
                   		 Please fill in Ship Street, Ship City, Ship State, Ship Phone and Ship Postal Code.
                  </div>
                <div class="slds-modal__footer">
                    <button class="slds-button slds-button--neutral" onclick="{!c.closeShipErrorModal}">Ok</button>
                </div>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
    </aura:if>
     <aura:if isTrue="{!v.addressvalidation}">
        <div role="dialog" tabindex="-1" aria-labelledby="header99" class="slds-modal slds-fade-in-open ">
            <div class="slds-modal__container">
                <div class="slds-modal__header" style="color:rgb(243, 81, 81)">
                    <button class="slds-button slds-modal__close slds-button--icon-inverse slds-text-heading_large" title="Close" onclick="{!c.closeShipErrorModal}">
                        <span>x</span>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Save Error</h2>
                </div>
                <div class="slds-modal__content slds-p-around--medium">
                        Entered address in invalid, Please re-enter the valid Address.
                </div>
                <div class="slds-modal__footer">
                    <button class="slds-button slds-button--neutral" onclick="{!c.closeShipErrorModal}">Ok</button>
                </div>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
    </aura:if>
    <aura:if isTrue="{!v.showSpinner}">
        <lightning:spinner variant="brand" size="large" />
    </aura:if>
    <div aura:id="formDiv" id="formDiv"></div>
    <div class="slds-grid slds-grid_align-center" aura:id="iframeDiv" id="iframeDiv">
        <div class="slds-size_1-of-1">
            <iframe src="" name="paymentFrame" id="paymentFrame" aura:id="paymentFrame" height="500px" width="100%" frameborder="0"></iframe>
        </div>
    </div>
</aura:component>